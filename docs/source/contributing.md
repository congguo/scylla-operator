# Contributing to Scylla Operator

## Prerequisites

To develop Scylla Operator, ensure your environment has the following items configured:

1. [Go](https://golang.org/dl)
   * Check `go.mod` for minimal version requirement.
2. Git client
3. GitHub account

## Initial Setup

### Fork the repository

Follow GitHub's official documentation on [forking a repository](https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/working-with-forks/fork-a-repo).

## Development

To add a feature or to make a bug fix, you will need to create a branch in your fork and then submit a pull request (PR) from the branch.
A subset of useful commands:
* `make build` - build project binaries
* `make test-unit` - run unit tests
* `make update` - run all code generators
* `make verify` - verify if all autogenerated changes are generated.

Check `make help` for more.

## Coding convention

Follow these guidelines for writing and structuring your code:
* [Effective Go](https://go.dev/doc/effective_go)
* [Go Code Review Comments](https://go.dev/wiki/CodeReviewComments)
* [API changes](https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api_changes.md)
* [API conventions](https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md)


In cases where the existing code doesn't fully follow these conventions, try to be consistent with what's already there. Make sure to familiarize yourself with these resources before making changes.

## Enhancement proposals

For significant features or API changes, you might be required to prepare an enhancement proposal beforehand, as these usually involve broader discussions. If unsure, please consult the [maintainers of the project](https://github.com/scylladb/scylla-operator/blob/master/OWNERS) to learn if your contribution falls into these categories before you start working on the implementation.  
For further details, see [Enhancement Proposals directory](https://github.com/scylladb/scylla-operator/tree/master/enhancements).

## Submitting a Pull Request

Once you have implemented the feature or bug fix in your branch, open a PR to the upstream repository. Before doing so, ensure the following:
- Unit tests are included.
- End-to-end tests are passing.
- Your commit history is clean.

### Commit History

To maintain a clean commit history, aim for a minimal number of logical commits. Typically, this means a single commit that contains all the changes, with a separate commit for autogenerated parts.

### Commits and PRs

The first line of your commit message and PR title should summarize the change in one clear sentence that would be meaningful to a user of the Operator. The sentence should use a verb in its base form to describe the change, e.g. "Add support for XYZ." .
Every release note is based on these first lines, so make them concise yet informative.

If you have more to say about the change, then enter a blank line and carry on the description.
Remember to say why the change was needed - the commit itself shows what was changed.

Writing more is better than less. Comparing the behavior before the change to that after the change is beneficial.
Imagine writing to yourself in 12 months when you've forgotten everything about what you just did, and you need to get up to speed quickly.

If the change fixes an issue, then write Fixes #1234 in the PR description.

Here is an example of a good commit message and PR title/description:
```

Add new XYZ field to ScyllaCluster CRD.

The new field allows for configuration of ZYX feature of ScyllaDB.
<more details>
API change was discussed in the following enhancement: <link>.

Fixes #1234
```

### Code review

Refer to [The Standard of Code Review](https://github.com/golang/go/wiki/CodeReviewComments) for best practices when conducting peer reviews or responding to feedback.

### Submitting

After addressing the review feedback, squash your changes into the original commits. Avoid adding new commits. Your PR should always be in a mergeable state.
